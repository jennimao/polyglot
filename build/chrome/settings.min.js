(()=>{let e={};const t=chrome.runtime.connect({name:"settings"});t.onMessage.addListener((t=>{e=t.settings||e,o()}));const n=[{upperBaselinePos:.2,lowerBaselinePos:.8},{upperBaselinePos:.15,lowerBaselinePos:.85},{upperBaselinePos:.1,lowerBaselinePos:.9}],a=[{secondaryLanguageMode:"disabled"},{secondaryLanguageMode:"audio"},{secondaryLanguageMode:"last"}];function c(){t.postMessage({settings:e})}function o(){if("complete"!==document.readyState)return;let t;[].forEach.call(document.querySelectorAll(".active"),(e=>{e.classList.remove("active")}));const c=n.findIndex((t=>t.lowerBaselinePos===e.lowerBaselinePos));-1!==c&&(t=document.querySelector(`.settings-layout > div[data-id="${c}"]`),t&&t.classList.add("active")),document.getElementById("primary-font-indicator").style.scale=.8*e.primaryTextScale,document.getElementById("primary-color").value=e.primaryTextColor||"#ffffff",document.getElementById("secondary-font-indicator").style.scale=.8*e.secondaryTextScale,document.getElementById("secondary-color").value=e.secondaryTextColor||"#ffffff";const o=a.findIndex((t=>t.secondaryLanguageMode===e.secondaryLanguageMode));-1!==o&&(t=document.querySelector(`.settings-secondary-lang > div[data-id="${o}"]`),t&&t.classList.add("active"),e.secondaryLanguageLastUsed&&(document.getElementById("langcode").innerHTML=e.secondaryLanguageLastUsed.split("-")[0]))}function s(t){if("+"===t)e.primaryTextScale=Math.min(2.5,e.primaryTextScale+.1);else{if("-"!==t)return;e.primaryTextScale=Math.max(.3,e.primaryTextScale-.1)}e.primaryImageScale=.6*e.primaryTextScale,c(),o()}function r(t){if("+"===t)e.secondaryTextScale=Math.min(2.5,e.secondaryTextScale+.1);else{if("-"!==t)return;e.secondaryTextScale=Math.max(.3,e.secondaryTextScale-.1)}e.secondaryImageScale=.6*e.secondaryTextScale,c(),o()}window.addEventListener("load",(d=>{!function(){let e=document.querySelector("#version");e&&(e.textContent="1.0.0")}(),o();const l=document.querySelectorAll(".settings-layout > div");[].forEach.call(l,(t=>{const a=parseInt(t.getAttribute("data-id"));t.addEventListener("click",(t=>function(t){t<0||t>=n.length||(e=Object.assign(e,n[t]),c(),o())}(a)),!1)})),document.getElementById("primary-plus").addEventListener("click",(()=>s("+"))),document.getElementById("primary-minus").addEventListener("click",(()=>s("-"))),document.getElementById("secondary-plus").addEventListener("click",(()=>r("+"))),document.getElementById("secondary-minus").addEventListener("click",(()=>r("-"))),document.getElementById("primary-color").onchange=t=>{var n;n=t.target.value,e=Object.assign(e,{primaryTextColor:n}),c(),o()},document.getElementById("secondary-color").onchange=t=>{var n;n=t.target.value,e=Object.assign(e,{secondaryTextColor:n}),c(),o()};const i=document.querySelectorAll(".settings-secondary-lang > div");[].forEach.call(i,(t=>{const n=parseInt(t.getAttribute("data-id"));t.addEventListener("click",(t=>function(t){t<0||t>=a.length||(e=Object.assign(e,a[t]),c(),o())}(n)),!1)})),document.getElementById("btnReset").addEventListener("click",(e=>{t.postMessage({settings:null})}),!1)}))})();